runtime: python
env: flex
entrypoint: gunicorn -b :$PORT main:app

runtime_config:
  python_version: 3

# [START configuration]
endpoints_api_service:
  # 'gcloud endpoints services deploy openapi-appengine.yaml' command.
  name: "[Project-URL]"
  config_id: "[Config-id]"
 # [END configuration]

#[START env]
env_variables:
    # Replace user, password, database, and instance connection name with the values obtained
    # when configuring your Cloud SQL instance.
    SQLALCHEMY_DATABASE_URI: >-
      postgresql+psycopg2://USER:PASSWORD@/DATABASE?host=/cloudsql/INSTANCE_CONNECTION_NAME
#[END env]

#[START cloudsql_settings]
# Replace project and instance with the values obtained  when configuring your
# Cloud SQL instance.
beta_settings:
    cloud_sql_instances: INSTANCE_CONNECTION_NAME
#[END cloudsql_settings]

handlers:
  - url: /docs
    static_files: docs/index.html
    upload: docs/index.html
  - url: /docs/(.*)
    static_files: docs/\1
    upload: docs/.
  - url: /api-docs
    static_files: openapi.yaml
    upload: openapi.yaml